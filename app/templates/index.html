{% extends "base.html" %}
{% load static %}

{% block title %}Home Page{% endblock %}

{% block body %}
<style>
  section {
    width: 100vw;
  }
  
  .carousel-item img {
    height: 360px;
  }

  @media(max-width: 450px) {
    .carousel-item img {
      height: 300px;
    }
  }

  /* Style the container with a horizontal scroll */
  .scroll-container {
    display: flex;
    overflow-x: auto;
    white-space: nowrap;
    padding: 20px;
  }

  /* Style the product section title and more link */
  .product-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0 20px;
  }

  /* Style each product card */
  .product-card {
    display: inline-block;
    width: 160px; /* Adjust as needed */
    margin-right: 10px;
    background-color: rgba(255, 255, 255, 0.75);
    text-align: center;
    padding: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  }

  /* Fixed size for images */
  .product-img img {
    width: 130px; /* Fixed width */
    height: 130px; /* Fixed height, adjust as needed */
    object-fit: cover; /* Cover to maintain aspect ratio */
  }

  .product-card p{
    text-decoration: none;
  }

  /* Responsive adjustments */
  @media (max-width: 600px) {
    .product-card {
      width: 120px; /* Smaller width on mobile */
    }
    .product-img img {
      width: 100px;
      height: 100px;
    }
    /* Make the scrollbar thinner on small screens */
    .scroll-container::-webkit-scrollbar {
      width: 4px; /* Adjust the thickness as needed */
    }

    .scroll-container::-webkit-scrollbar-thumb {
      background: rgba(0, 0, 0, 0.2); /* Scrollbar thumb color */
      border-radius: 2px; /* Rounded corners for the thumb */
    }

    /* For Firefox */
    .scroll-container {
      scrollbar-width: thin;
    }
  }
  .icon-wrapper {
    display: flex;
    width: 97px;
    margin-right: 10px;
    background-color: rgba(255, 255, 255, 0.75);
    text-align: center;
    padding: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    border-radius: 20px;
  }
  .icon-wrapper a {
    text-decoration: none;
  }
  .icon-img{
    height: 80px;
    width: 80px;
  }
  .icon-img img {
    height: 100%;
    width: 100%;
    object-fit: cover;
  }
  .news-wrapper {
    position: relative;
    align-items: center;
    background-color: rgba(255, 255, 255, 0.35);
    border-radius: 10px;
    overflow: hidden;
  }
  @media(min-width: 991.9px){
    .news-wrapper {
      width: 102%;
    }
  }
  .img-container {
    position: relative;
    overflow: hidden;
    height: 100px;
  }
  .img-container img {
    height: 250px;
    width: 100%;
  }
  .like-button {
    color: white;
    cursor: pointer;
  }
  a {
    text-decoration: none;
  }
  @media (min-width: 768px) {
    .likes-wrap {
      margin-right: 20px;
    }
  }

</style>

<section id="body-container">
  <div class="container-fluid">
    <div class="row">
      <div class="carousel-wrapper w-100 pb-lg-5">
        <div id="carouselExampleCaptions" class="carousel-body carousel slide" data-bs-ride="carousel">
          <div class="carousel-indicators">
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
            <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
          </div>
          <div class="carousel-inner h-lg-50">
            <div class="carousel-item active">
              <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1700386958/bcoin/images/carousel/office1_obevnd.jpg" class="d-block w-100" alt="...">
              <div class="carousel-caption d-none d-md-block">
                <h5>Efficient Mining Infrastructure</h5>
                <p>Experience the power of our cutting-edge mining setup designed for optimal efficiency and maximum returns in the crypto world.</p>
              </div>
            </div>
            <div class="carousel-item">
              <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1700386926/bcoin/images/carousel/office2_ye5tq0.jpg" class="d-block w-100" alt="...">
              <div class="carousel-caption d-none d-md-block">
                <h5>Next-Gen Mining Rigs</h5>
                <p>Explore the heart of our mining operation with state-of-the-art rigs delivering high hash rates for optimal performance and profitability.</p>
              </div>
            </div>
            <div class="carousel-item">
              <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1701785869/bcoin/images/carousel_3_alyo4b.jpg" class="d-block w-100" alt="...">
              <div class="carousel-caption d-none d-md-block">
                <h5>The Future of Digital Currency</h5>
                <p>Step into the future with our advanced cryptocurrency mining workspace, where innovation meets opportunity for financial growth.</p>
              </div>
            </div>
          </div>
          <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Previous</span>
          </button>
          <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
            <span class="carousel-control-next-icon" aria-hidden="true"></span>
            <span class="visually-hidden">Next</span>
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="row pt-3">
      <div class="col text-center">
        <h1 class="display-4 text-uppercase text-white mb-0" style="font-size: 50px;">
            <strong>services</strong>
        </h1>
        <div class="title-underline bg-primary"></div>
        <p class="mt-2 text-capitalize text-faded d-none d-lg-block">Click on a card to subscribe.</p>
        <p class="mt-2 text-capitalize text-faded d-block d-lg-none">Click to view options.</p>
      </div>
    </div>
    <div class="row d-flex">
        <div class="col-4 col-md-2 py-2">
          <div class="icon-wrapper d-block justify-content-center">
            <a href="/contact/">
              <div class="icon-img">
                <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1700386861/bcoin/images/service/service3_c2lnjc.png" alt="">
              </div>
              <div>Contact Us</div>
            </a>
          </div>
        </div>
        <div class="col-4 col-md-2 py-2">
          <div class="icon-wrapper d-block justify-content-center">
            <a href="/invite/">
              <div class="icon-img">
                <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1700386939/bcoin/no%20bg/invite1_jctwc6.png" alt="">
              </div>
              <div>Invite+</div>
            </a>
          </div>
        </div>
        <div class="col-4 col-md-2 py-2">
          <div class="icon-wrapper d-block justify-content-center">
            <a href="/initiate_recharge/">
              <div class="icon-img">
                <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1700386821/bcoin/no%20bg/recharge1_lh0icf.png" alt="">
              </div>
              <div>Recharge</div>
            </a>
          </div>
        </div>
        <div class="col-4 col-lg-2 py-2">
          <div class="icon-wrapper d-block justify-content-center">
            <a href="/withdraw/">
              <div class="icon-img">
                <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1700386806/bcoin/no%20bg/withdraw3_xqamvh.png" alt="">
              </div>
              <div>Withdraw</div>
            </a>
          </div>
        </div>
        <div class="col-4 col-lg-2 py-2">
          <div class="icon-wrapper d-block justify-content-center">
            <a href="/my_team/">
              <div class="icon-img">
                <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1700386925/bcoin/no%20bg/my_team1_ht928a.png" alt="">
              </div>
              <div>Team</div>
            </a>
          </div>
        </div>
        <div class="col-4 col-lg-2 py-2">
          <div class="icon-wrapper d-block justify-content-center">
            <a href="/my_machines/">
              <div class="icon-img">
                <img src="https://res.cloudinary.com/dl6uac51b/image/upload/v1700386822/bcoin/no%20bg/my_machine_xnjtnj.png" alt="">
              </div>
              <div>Machines</div>
            </a>
          </div>
        </div>
    </div>
  </div>
  <div class="container pb-5">
    <div class="product-header">
      <h2 class="text-white">Products</h2>
      <a href="/products/">More ></a>
    </div>

    <div class="scroll-container">

      {% for product in products %}
        <!-- Placeholder for Products -->
        <a href="/product/{{ product.pk }}/">
          <div class="product-card">
            <div class="product-img">
              <img
                src="{{ product.image }}"
                class="bg-white"
                alt="smh"
              />
            </div>
            <p>
              {{ product.name }} <br />
              Ksh {{ product.cost }}
            </p>
          </div>
        </a>
      {% endfor %}

    </div>
  </div>

  {% if discounted_products %}
    <div class="container pb-5">
      <div class="product-header">
        <h2 class="text-white">Discounted</h2>
        <a href="/products/">More ></a>
      </div>

      <div class="scroll-container">
        {% for product in discounted_products %}
        <!-- Placeholder for Products -->
        <a href="/product/{{ product.pk }}/">
          <div class="product-card">
            <div class="product-img">
              <img
                src="{{ product.image }}"
                alt="smh"
                class="bg-white"
              />
            </div>
            <p>
              {{ product.name }} <br />
              Ksh {{ product.cost }} <br>
              <span class="text-center text-decoration-line-through">Ksh {{ product.from_price }}</span>
            </p>
          </div>
        </a>
        {% endfor %}
      </div>
    </div>
  {% endif %}
  <div class="container">
    <div class="row pt-3">
      <div class="col text-center">
        <h1 class="display-4 text-uppercase text-white mb-0" style="font-size: 50px;">
            <strong>News Feeds</strong>
        </h1>
        <div class="title-underline bg-primary"></div>
        <p class="mt-2 text-capitalize text-faded">View latest trends in the crypto world..</p>
      </div>
    </div>
    <div class="row">
      {% if news_feeds %}
      {% for news in news_feeds %}
      <div class="col-lg-4 col-md-6 col-sm-12 pb-3">
        <a href="/news_feeds/{{ news.pk }}/">
          <div class="news-wrapper mx-auto">
            <div class="img-container mx-auto">
              <img src="{{ news.image }}" alt="">
            </div>
            <div class="mx-auto">
              <div class="d-flex d-md-none justify-content-between">
                <h5 class="text-warning ps-2">{{ news.title }}</h5>
                <div class="icons d-flex justify-content-between">
                  <p class="text-white d-flex align-items-center px-5">
                    <span class="p-1">
                      <i class="fa fa-eye" aria-hidden="true"></i>
                    </span>
                    <span class="p-1">
                      {{ news.views }}
                    </span>
                  </p>
                  <p class="likes-wrap text-white d-flex align-items-center">
                    <span class="p-1 like-button">
                      <i class="fa fa-thumbs-up" aria-hidden="true"></i>
                    </span>
                    <span class="p-1">
                      {{ news.likes }}
                    </span>
                  </p>
                </div>
              </div>
              <div class="d-none d-md-block justify-content-between">
                <h5 class="text-warning ps-2 text-md-center">{{ news.title }}</h5>
                <div class="icons d-flex justify-content-between">
                  <p class="text-white d-flex align-items-center px-5">
                    <span class="p-1">
                      <i class="fa fa-eye" aria-hidden="true"></i>
                    </span>
                    <span class="p-1">
                      {{ news.views }}
                    </span>
                  </p>
                  <p class="likes-wrap text-white d-flex align-items-center">
                    <span class="p-1 like-button" id="like-button-{{ news.id }}">
                      <i class="fa fa-thumbs-up" aria-hidden="true"></i>
                    </span>
                    <span class="p-1" id="like-count-{{ news.id }}">
                      {{ news.likes }}
                    </span>
                  </p>
                </div>
              </div>
            </div>
          </div>
        </a>
        <script>
          // This function will be called when the page is loaded
          document.addEventListener('DOMContentLoaded', function() {
              // Find all like buttons on the page
              var likeButtons = document.querySelectorAll('.like-button');

              // Add a click event listener to each like button
              likeButtons.forEach(function(button) {
                  button.addEventListener('click', function(event) {
                      // Prevent the default action
                      event.preventDefault();

                      // Get the news ID from the button's ID attribute
                      var newsId = this.id.split('-')[2];

                      // Send a POST request to the server
                      fetch('/adm/increase_like?newsId=' + newsId, { method: 'POST' })
                          .then(response => response.json())
                          .then(data => {
                              if (data.success) {
                                  // Update the like count on the page
                                  var likeCountElement = document.getElementById('like-count-' + newsId);
                                  likeCountElement.textContent = data.newLikeCount;
                              }
                          })
                          .catch(error => console.error('Error:', error));
                  });
              });
          });

        </script>
      </div>
      {% endfor %}
      {% else %}
      <p>No news feeds yet</p>
      {% endif %}
    </div>
  </div>
</section>
{% endblock %}
